# ğŸ‘‹ ì œìŠ¤ì²˜ ì¸ì‹ í”„ë¡œì íŠ¸

ì›¹ìº ì„ í†µí•´ ì‹¤ì‹œê°„ìœ¼ë¡œ ì† ì œìŠ¤ì²˜(ì˜ˆ: 'ê°€ìœ„', 'ë°”ìœ„', 'ë³´')ë¥¼ ì¸ì‹í•˜ëŠ” ë”¥ëŸ¬ë‹ í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤. MediaPipeë¡œ ì† ëœë“œë§ˆí¬ë¥¼ ì¶”ì¶œí•˜ê³ , TensorFlow/Keras ê¸°ë°˜ì˜ CNN ëª¨ë¸ë¡œ ì œìŠ¤ì²˜ë¥¼ ë¶„ë¥˜í•©ë‹ˆë‹¤.

**ì´ í”„ë¡œì íŠ¸ì˜ ëª¨ë“  ì½”ë“œì™€ í•™ìŠµëœ ëª¨ë¸ì€ MIT Licenseì— ë”°ë¼ ë°°í¬ë©ë‹ˆë‹¤.**

---

## âœ¨ ì£¼ìš” ê¸°ëŠ¥

-   **ì‹¤ì‹œê°„ ì œìŠ¤ì²˜ ì¸ì‹**: ì›¹ìº ì„ í™œìš©í•˜ì—¬ ì† ì œìŠ¤ì²˜ë¥¼ ì¦‰ì‹œ ê°ì§€í•˜ê³  ë¶„ë¥˜í•©ë‹ˆë‹¤.<br><br>
-   **ë°ì´í„° ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸**: ì´ë¯¸ì§€ì—ì„œ ì† ëœë“œë§ˆí¬ë¥¼ ì¶”ì¶œí•˜ê³  ì •ê·œí™”í•˜ì—¬ í•™ìŠµìš© ë°ì´í„°ì…‹ì„ ìë™ìœ¼ë¡œ ìƒì„±í•©ë‹ˆë‹¤.<br><br>
-   **ëª¨ë¸ í•™ìŠµ ë° ë³€í™˜**: CNN ëª¨ë¸ì„ í•™ìŠµì‹œí‚¤ê³ , ì‹¤ì‹œê°„ ì¶”ë¡ ì— ìµœì í™”ëœ TensorFlow Lite (`.tflite`) ëª¨ë¸ë¡œ ìë™ ë³€í™˜í•©ë‹ˆë‹¤.<br><br>
-   **ëª¨ë“ˆí™”ëœ êµ¬ì¡°**: ì„¤ì •, ë°ì´í„° ì²˜ë¦¬, ëª¨ë¸ í•™ìŠµ, ì‹¤ì‹œê°„ í…ŒìŠ¤íŠ¸ ë“± ê¸°ëŠ¥ë³„ë¡œ ì½”ë“œê°€ ëª…í™•í•˜ê²Œ ë¶„ë¦¬ë˜ì–´ ìˆì–´ ìœ ì§€ë³´ìˆ˜ì™€ í™•ì¥ì´ ìš©ì´í•©ë‹ˆë‹¤.<br><br>
-   **Basic ë° Transfer í•™ìŠµ ì§€ì›**: ê¸°ë³¸ ì œìŠ¤ì²˜ í•™ìŠµê³¼ ìƒˆë¡œìš´ ì œìŠ¤ì²˜ ì¶”ê°€ë¥¼ ìœ„í•œ ì „ì´ í•™ìŠµì„ ëª¨ë‘ ì§€ì›í•©ë‹ˆë‹¤.<br>

---

## ğŸ“‚ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
gesture/
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ image_data/         # ê¸°ë³¸ í•™ìŠµìš© ì›ë³¸ ì´ë¯¸ì§€ (ê°€ìœ„, ë°”ìœ„, ë³´ ë“±)
â”‚   â”œâ”€â”€ new_image_data/     # ì „ì´ í•™ìŠµìš© ìƒˆë¡œìš´ ì œìŠ¤ì²˜ ì´ë¯¸ì§€
â”‚   â””â”€â”€ processed/          # ì „ì²˜ë¦¬ëœ ë°ì´í„° (csv, npy ë“±)
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ basic_gesture_model.keras # ê¸°ë³¸ í•™ìŠµëœ Keras ëª¨ë¸
â”‚   â”œâ”€â”€ basic_gesture_model.tflite# ê¸°ë³¸ í•™ìŠµëœ TFLite ëª¨ë¸
â”‚   â”œâ”€â”€ basic_label_map.json      # ê¸°ë³¸ ì œìŠ¤ì²˜ ë¼ë²¨ ë§µ
â”‚   â”œâ”€â”€ transfer_gesture_model.keras # ì „ì´ í•™ìŠµëœ Keras ëª¨ë¸
â”‚   â”œâ”€â”€ transfer_gesture_model.tflite# ì „ì´ í•™ìŠµëœ TFLite ëª¨ë¸
â”‚   â””â”€â”€ transfer_label_map.json      # ì „ì´ í•™ìŠµ ì œìŠ¤ì²˜ ë¼ë²¨ ë§µ
â””â”€â”€ src/
    â”œâ”€â”€ main.py             # ë°ì´í„° ì²˜ë¦¬ ë° ëª¨ë¸ í•™ìŠµ íŒŒì´í”„ë¼ì¸ ì‹¤í–‰
    â”œâ”€â”€ live_test.py        # ì‹¤ì‹œê°„ ì œìŠ¤ì²˜ ì¸ì‹ ì‹¤í–‰
    â”œâ”€â”€ config.py           # í”„ë¡œì íŠ¸ ì„¤ì • ê´€ë¦¬
    â”œâ”€â”€ data_processor.py   # ì´ë¯¸ì§€ ì „ì²˜ë¦¬ ë° ëœë“œë§ˆí¬ ì¶”ì¶œ
    â”œâ”€â”€ data_manager.py     # ë°ì´í„°ì…‹ ë¶„í•  ë° ì €ì¥
    â””â”€â”€ model_trainer.py    # ëª¨ë¸ ì •ì˜ ë° í•™ìŠµ
```

---

## ğŸš€ ì‹œì‘í•˜ê¸°

### 1. í™˜ê²½ ì„¤ì •

í”„ë¡œì íŠ¸ ì‹¤í–‰ì— í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë“¤ì„ ì„¤ì¹˜í•©ë‹ˆë‹¤.

```bash
pip install -r requirements.txt
```

### 2. ë°ì´í„° ì¤€ë¹„

`gesture/data/image_data/` í´ë”ëŠ” ì €ì‘ê¶Œ ë° ë¼ì´ì„¼ìŠ¤ ë¬¸ì œë¡œ ì¸í•´ Git ì €ì¥ì†Œì— í¬í•¨ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì´ í´ë”ì—ëŠ” ì£¼ë¡œ **Google MediaPipeì—ì„œ ì œê³µí•˜ëŠ” ì˜ˆì‹œ ì´ë¯¸ì§€**ë‚˜ ê³µê°œëœ ë°ì´í„°ì…‹ì—ì„œ ê°€ì ¸ì˜¨ í•™ìŠµìš© ì´ë¯¸ì§€ ë°ì´í„°ë¥¼ ì¤€ë¹„í•´ ì£¼ì„¸ìš”.

ìƒˆë¡œìš´ ì œìŠ¤ì²˜ë¥¼ ì¶”ê°€í•˜ê±°ë‚˜ ê¸°ì¡´ ë°ì´í„°ë¥¼ ë³´ê°•í•˜ë ¤ë©´ `gesture/data/image_data/` ë””ë ‰í† ë¦¬ ì•„ë˜ì— ì œìŠ¤ì²˜ ì´ë¦„ìœ¼ë¡œ í´ë”ë¥¼ ë§Œë“¤ê³  ì´ë¯¸ì§€ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.

**ì „ì´ í•™ìŠµì„ ìœ„í•œ ë°ì´í„°**: `gesture/data/new_image_data/` í´ë”ì—ëŠ” **ì§ì ‘ ì¹´ë©”ë¼ë¡œ ì´¬ì˜í•œ ìƒˆë¡œìš´ ì œìŠ¤ì²˜ ì´ë¯¸ì§€**ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤. ì´ í´ë”ì˜ ë°ì´í„°ëŠ” ê¸°ì¡´ `image_data`ì™€ í•¨ê»˜ ì „ì´ í•™ìŠµì— ì‚¬ìš©ë©ë‹ˆë‹¤.

MediaPipe Gesture Recognizerì— ëŒ€í•œ ìì„¸í•œ ì •ë³´ëŠ” [ì—¬ê¸°](https://ai.google.dev/edge/mediapipe/solutions/vision/gesture_recognizer?hl=ko)ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### 3. ëª¨ë¸ í•™ìŠµ (`main.py`)

`main.py`ë¥¼ ì‹¤í–‰í•˜ì—¬ ë°ì´í„° ì²˜ë¦¬ë¶€í„° ëª¨ë¸ í•™ìŠµê¹Œì§€ ì „ì²´ íŒŒì´í”„ë¼ì¸ì„ ì‹¤í–‰í•©ë‹ˆë‹¤. `--mode` ì¸ìë¥¼ ì‚¬ìš©í•˜ì—¬ í•™ìŠµ ëª¨ë“œë¥¼ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

*   **Basic ëª¨ë¸ í•™ìŠµ (ê¸°ë³¸ í•™ìŠµ)**:<br>
    `gesture/data/image_data/`ì˜ ì´ë¯¸ì§€ë¥¼ ê¸°ë°˜ìœ¼ë¡œ `basic_hand_landmarks.csv`, `basic_train_data.npy`, `basic_test_data.npy`ë¥¼ ìƒì„±í•˜ê³ , `basic_gesture_model.keras`, `basic_gesture_model.tflite`, `basic_label_map.json`ì„ `models` í´ë”ì— ì €ì¥í•©ë‹ˆë‹¤.
    ```bash
    python gesture/src/main.py --mode train
    ```

*   **Transfer ëª¨ë¸ í•™ìŠµ (ì „ì´ í•™ìŠµ)**:<br>
    `gesture/data/image_data/`ì™€ `gesture/data/new_image_data/`ì˜ ë°ì´í„°ë¥¼ ëª¨ë‘ ì‚¬ìš©í•˜ì—¬ `transfer_hand_landmarks.csv`, `transfer_train_data.npy`, `transfer_test_data.npy`ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.<br><br> ê¸°ì¡´ `basic_gesture_model.keras`ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì „ì´ í•™ìŠµì„ ìˆ˜í–‰í•˜ì—¬ `transfer_gesture_model.keras`, `transfer_gesture_model.tflite`, `transfer_label_map.json`ì„ `models` í´ë”ì— ì €ì¥í•©ë‹ˆë‹¤. `--base_model_path` ì¸ìë¡œ ê¸°ë³¸ ëª¨ë¸ì˜ ê²½ë¡œë¥¼ ì§€ì •í•´ì•¼ í•©ë‹ˆë‹¤.
    ```bash
    python gesture/src/main.py --mode transfer --base_model_path gesture/models/basic_gesture_model.keras
    ```

### 4. ì‹¤ì‹œê°„ ì œìŠ¤ì²˜ ì¸ì‹ (`live_test.py`)

`live_test.py`ë¥¼ ì‹¤í–‰í•˜ì—¬ ì›¹ìº ì„ í†µí•´ í•™ìŠµëœ ëª¨ë¸ì˜ ì„±ëŠ¥ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ í™•ì¸í•©ë‹ˆë‹¤. `--model_type` ì¸ìë¥¼ ì‚¬ìš©í•˜ì—¬ ì‚¬ìš©í•  ëª¨ë¸ì„ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

*   **Basic ëª¨ë¸ë¡œ í…ŒìŠ¤íŠ¸**:<br>
    `basic_gesture_model.tflite`ì™€ `basic_label_map.json`ì„ ì‚¬ìš©í•˜ì—¬ ì‹¤ì‹œê°„ ì¸ì‹ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.
    ```bash
    python gesture/src/live_test.py --model_type basic
    ```
    (ë˜ëŠ” `--model_type basic`ì´ ê¸°ë³¸ê°’ì´ë¯€ë¡œ ë‹¨ìˆœíˆ `python gesture/src/live_test.py`ë¡œ ì‹¤í–‰í•´ë„ ë©ë‹ˆë‹¤.)<br><br>

*   **Transfer ëª¨ë¸ë¡œ í…ŒìŠ¤íŠ¸**:<br>
    `transfer_gesture_model.tflite`ì™€ `transfer_label_map.json`ì„ ì‚¬ìš©í•˜ì—¬ ì‹¤ì‹œê°„ ì¸ì‹ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.
    ```bash
    python gesture/src/live_test.py --model_type transfer
    ```
ESC í‚¤ë¥¼ ëˆ„ë¥´ë©´ í”„ë¡œê·¸ë¨ì´ ì¢…ë£Œë©ë‹ˆë‹¤. ì†ì´ ê°ì§€ë˜ì§€ ì•Šì„ ê²½ìš° "none"ì´ ì¶œë ¥ë©ë‹ˆë‹¤.

---

## âš™ï¸ ì‘ë™ ì›ë¦¬

1.  **ë°ì´í„° ì²˜ë¦¬ (`data_processor.py`)**:
    -   `image_data` ë˜ëŠ” `new_image_data` í´ë”ì˜ ì´ë¯¸ì§€ë¥¼ ì½ì–´ë“¤ì…ë‹ˆë‹¤.
    -   MediaPipe Handsë¥¼ ì‚¬ìš©í•˜ì—¬ ê° ì´ë¯¸ì§€ì—ì„œ 21ê°œì˜ ì† ëœë“œë§ˆí¬ ì¢Œí‘œ(x, y, z)ë¥¼ ì¶”ì¶œí•©ë‹ˆë‹¤.
    -   ì¶”ì¶œëœ ëœë“œë§ˆí¬ë¥¼ **ì´ë™(translation), í¬ê¸°(scale), íšŒì „(rotation)**ì— ëŒ€í•´ ì •ê·œí™”í•˜ì—¬ ì†ì˜ ìœ„ì¹˜, í¬ê¸°, ë°©í–¥ì— ê´€ê³„ì—†ì´ ì¼ê´€ëœ íŠ¹ì§•ì„ í•™ìŠµí•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤.
    -   ì²˜ë¦¬ëœ ëœë“œë§ˆí¬ ë°ì´í„°ì™€ ë¼ë²¨ì„ `basic_hand_landmarks.csv` ë˜ëŠ” `transfer_hand_landmarks.csv` íŒŒì¼ë¡œ ì €ì¥í•©ë‹ˆë‹¤.<br><br>

2.  **ë°ì´í„° ê´€ë¦¬ (`data_manager.py`)**:
    -   ìƒì„±ëœ ëœë“œë§ˆí¬ CSV íŒŒì¼ì„ ë¡œë“œí•©ë‹ˆë‹¤.
    -   ë°ì´í„°ë¥¼ í•™ìŠµìš©(train)ê³¼ í…ŒìŠ¤íŠ¸ìš©(test)ìœ¼ë¡œ ë¶„í• í•˜ê³ , ëª¨ë¸ í•™ìŠµì— ì í•©í•œ NumPy ë°°ì—´(`.npy`) í˜•íƒœë¡œ ì €ì¥í•©ë‹ˆë‹¤. (ì˜ˆ: `basic_train_data.npy`, `transfer_test_data.npy`)<br><br>

3.  **ëª¨ë¸ í•™ìŠµ (`model_trainer.py`)**:
    -   ë¶„í• ëœ `.npy` ë°ì´í„°ì…‹ì„ ë¡œë“œí•©ë‹ˆë‹¤.
    -   **Basic í•™ìŠµ**: ìƒˆë¡œìš´ CNN(Convolutional Neural Network) ëª¨ë¸ì„ êµ¬ì„±í•˜ê³  í•™ìŠµì‹œí‚µë‹ˆë‹¤. ê°€ì¥ ì„±ëŠ¥ì´ ì¢‹ì€ ëª¨ë¸ì„ `basic_gesture_model.keras`ë¡œ ì €ì¥í•˜ê³ , ê²½ëŸ‰í™”ëœ `basic_gesture_model.tflite` íŒŒì¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.<br><br>
    
    -   **Transfer í•™ìŠµ**: ê¸°ì¡´ `basic_gesture_model.keras`ë¥¼ ë¶ˆëŸ¬ì™€ íŠ¹ì§• ì¶”ì¶œê¸°ë¡œ ì‚¬ìš©í•˜ê³ , ìƒˆë¡œìš´ ë¶„ë¥˜ ë ˆì´ì–´ë¥¼ ì¶”ê°€í•˜ì—¬ ì „ì´ í•™ìŠµì„ ìˆ˜í–‰í•©ë‹ˆë‹¤. í•™ìŠµëœ ëª¨ë¸ì€ `transfer_gesture_model.keras`ë¡œ ì €ì¥ë˜ê³  `transfer_gesture_model.tflite`ë¡œ ë³€í™˜ë©ë‹ˆë‹¤.
    -   ê° í•™ìŠµ ëª¨ë“œì— ë§ëŠ” ë¼ë²¨ ë§µ (`basic_label_map.json` ë˜ëŠ” `transfer_label_map.json`)ì„ ìƒì„±í•˜ê³  ì €ì¥í•©ë‹ˆë‹¤.<br><br>

4.  **ì‹¤ì‹œê°„ í…ŒìŠ¤íŠ¸ (`live_test.py`)**:
    -   ì„ íƒëœ ëª¨ë¸ (`basic_gesture_model.tflite` ë˜ëŠ” `transfer_gesture_model.tflite`)ê³¼ í•´ë‹¹ ë¼ë²¨ ë§µì„ ë¡œë“œí•©ë‹ˆë‹¤.
    -   OpenCVë¥¼ ì‚¬ìš©í•˜ì—¬ ì›¹ìº  í”¼ë“œë¥¼ ë°›ì•„ì˜µë‹ˆë‹¤.
    -   ê° í”„ë ˆì„ì—ì„œ ì† ê°ì§€ í›„ ëœë“œë§ˆí¬ë¥¼ ì¶”ì¶œí•œ ë’¤, í•™ìŠµ ì‹œì™€ ë™ì¼í•œ ë°©ì‹ìœ¼ë¡œ ì •ê·œí™”í•©ë‹ˆë‹¤.
    -   TFLite ëª¨ë¸ì„ í†µí•´ ì •ê·œí™”ëœ ëœë“œë§ˆí¬ë¥¼ ì…ë ¥ìœ¼ë¡œ ì œìŠ¤ì²˜ë¥¼ ì˜ˆì¸¡í•˜ê³ , ê²°ê³¼ë¥¼ í™”ë©´ì— í‘œì‹œí•©ë‹ˆë‹¤.
    -   ì†ì´ ê°ì§€ë˜ì§€ ì•Šì„ ê²½ìš° "none"ì„ ì¶œë ¥í•˜ë„ë¡ ë¡œì§ì´ ê°œì„ ë˜ì—ˆìŠµë‹ˆë‹¤.

---

## ğŸ› ï¸ ì£¼ìš” ê¸°ìˆ  ìŠ¤íƒ

-   **Python**
-   **TensorFlow / Keras**: ëª¨ë¸ í•™ìŠµ ë° ì¶”ë¡ 
-   **MediaPipe**: ì† ëœë“œë§ˆí¬ ì¶”ì¶œ
-   **OpenCV**: ì‹¤ì‹œê°„ ì˜ìƒ ì²˜ë¦¬
-   **NumPy, Pandas**: ë°ì´í„° ì²˜ë¦¬
-   **Scikit-learn**: ë°ì´í„° ë¶„í• 